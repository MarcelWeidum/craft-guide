{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% requirePermission 'editGuideNavigation' %}

{% do view.registerAssetBundle("wbrowar\\guide\\assetbundles\\guide\\GuideAsset") %}

{# Link for the ? icon at the bottom of the page #}
{% set docsUrl = "https://github.com/wbrowar/guide/blob/master/README.md" %}

{# The title of this CP section #}
{% set title = "Navigation" %}

{# The URL to this plugin's base CP section #}
{% set pluginCpUrl = url('guide/home') %}

{# The selected CP subnav item #}
{% set selectedSubnavItem = 'navigation' %}

{# Get a URL to an image in our AssetBundle #}
{% set iconUrl = view.getAssetManager().getPublishedPath('@wbrowar/guide/assetbundles/guide/dist', true) ~ '/icon/guide-mask.svg' %}

{% set fullPageForm = true %}

{% block actionButton %}
    <input class="btn submit" type="submit" value="Save">
{% endblock %}

{% set content %}
    <input type="hidden" name="action" value="guide/user-guide/save-cp-navigation">

    {{ forms.editableTableField({
        id: 'links',
        name: 'links',
        minRows: 0,
        addRowLabel: 'Add a link',
        instructions: 'Manage Guide CP section navigation',
        cols: {
            title: {
                heading: 'Title*',
                type: 'singleline',
            },
            slug: {
                heading: 'Slug*',
                type: 'singleline',
            },
            templatePath: {
                heading: 'Template Path',
                type: 'singleline',
            },
            permissions: {
                heading: 'Permissions (separate by comma)',
                type: 'singleline',
            },
            adminOnly: {
                heading: 'Admin Only',
                type: 'lightswitch',
            },
            guideId: {
                heading: 'User Guide ID',
                type: 'number',
            },
        },
        rows: guideNav ?? [],
    }) }}
{% endset %}